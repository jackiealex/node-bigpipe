(function(e){function g(e){var t=m[e]={};return f(e.split(/\s+/),function(e){t[e]=!0}),t}var t={},n=Array.prototype,r=Object.prototype,i=r.hasOwnProperty,s=r.toString,o=n.forEach,u=n.indexOf,a=n.slice,f=function(e,n,r){var s,u,a;if(!e)return;if(o&&e.forEach===o)e.forEach(n,r);else if(e.length===+e.length){for(u=0,a=e.length;u<a;u++)if(u in e&&n.call(r,e[u],u,e)===t)return}else for(s in e)if(i.call(e,s)&&n.call(r,e[s],s,e)===t)return},l=function(e){return!!(e&&e.constructor&&e.call&&e.apply)},c=function(e){return f(a.call(arguments,1),function(t){var n;for(n in t)t[n]!==void 0&&(e[n]=t[n])}),e},h=function(e,t,n){var r;if(t){if(u)return u.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},p={};f("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){p["[object "+e+"]"]=e.toLowerCase()});var d=function(e){return e==null?String(e):p[s.call(e)]||"object"},v={},m={};v.Callbacks=function(e){e=typeof e=="string"?m[e]||g(e):c({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],l=function(f){t=e.memory&&f,n=!0,o=i||0,i=0,s=u.length,r=!0;for(;u&&o<s;o++)if(u[o].apply(f[0],f[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&l(a.shift()):t?u=[]:p.disable())},p={add:function(){if(u){var n=u.length;(function o(t){f(t,function(t){var n=d(t);n==="function"?(!e.unique||!p.has(t))&&u.push(t):t&&t.length&&n!=="string"&&o(t)})})(arguments),r?s=u.length:t&&(i=n,l(t))}return this},remove:function(){return u&&f(arguments,function(e){var t;while((t=h(e,u,t))>-1)u.splice(t,1),r&&(t<=s&&s--,t<=o&&o--)}),this},has:function(e){return h(e,u)>-1},empty:function(){return u=[],this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||p.disable(),this},locked:function(){return!a},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],u&&(!n||a)&&(r?a.push(t):l(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!n}};return p},v.Deferred=function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){f(t,function(t,r){var s=t[0],o=e[r];i[t[1]](l(o)?function(){var e;try{e=o.apply(this,arguments)}catch(t){n.reject(t);return}e&&l(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s!=="notify"?"resolveWith":s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?c(e,r):r}},i={};return r.pipe=r.then,f(t,function(e,s){var o=e[2],u=e[3];r[e[1]]=o.add,u&&o.add(function(){n=u},t[s^1][2].disable,t[2][2].lock),i[e[0]]=o.fire,i[e[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},v.when=function(e){var t=0,n=d(e)==="array"&&arguments.length===1?e:a.call(arguments),r=n.length;d(e)==="array"&&e.length===1&&(e=e[0]);var i=r!==1||e&&l(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?a.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,f,c;if(r>1){u=new Array(r),f=new Array(r),c=new Array(r);for(;t<r;t++)n[t]&&l(n[t].promise)?n[t].promise().done(o(t,c,n)).fail(s.reject).progress(o(t,f,u)):--i}return i||s.resolveWith(c,n),s.promise()},typeof module!="undefined"&&module.exports?module.exports=v:typeof e._!="undefined"?e._.mixin(v):e._=v})(this)