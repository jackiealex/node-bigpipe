(function(){var e,t,n,r;(function(){var i={},s={};e=function(e,t,n){i[e]={deps:t,callback:n}},r=n=t=function(e){function p(t){if(t.charAt(0)!==".")return t;var n=t.split("/"),r=e.split("/").slice(0,-1);for(var i=0,s=n.length;i<s;i++){var o=n[i];if(o==="..")r.pop();else{if(o===".")continue;r.push(o)}}return r.join("/")}r._eak_seen=i;if(s[e])return s[e];s[e]={};if(!i[e])throw new Error("Could not find module "+e);var n=i[e],o=n.deps,u=n.callback,a=[],f;for(var l=0,c=o.length;l<c;l++)o[l]==="exports"?a.push(f={}):a.push(t(p(o[l])));var h=u.apply(this,a);return s[e]=f||h}})(),e("promise/all",["./utils","exports"],function(e,t){"use strict";function i(e){var t=this;if(!n(e))throw new TypeError("You must pass an array to all.");return new t(function(t,n){function u(e){return function(t){a(e,t)}}function a(e,n){i[e]=n,--s===0&&t(i)}var i=[],s=e.length,o;s===0&&t([]);for(var f=0;f<e.length;f++)o=e[f],o&&r(o.then)?o.then(u(f),n):a(f,o)})}var n=e.isArray,r=e.isFunction;t.all=i}),e("promise/asap",["exports"],function(e){"use strict";function i(){return function(){process.nextTick(a)}}function s(){var e=0,t=new n(a),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function o(){return function(){r.setTimeout(a,1)}}function a(){for(var e=0;e<u.length;e++){var t=u[e],n=t[0],r=t[1];n(r)}u=[]}function l(e,t){var n=u.push([e,t]);n===1&&f()}var t=typeof window!="undefined"?window:{},n=t.MutationObserver||t.WebKitMutationObserver,r=typeof global!="undefined"?global:this===undefined?window:this,u=[],f;typeof process!="undefined"&&{}.toString.call(process)==="[object process]"?f=i():n?f=s():f=o(),e.asap=l}),e("promise/config",["exports"],function(e){"use strict";function n(e,n){if(arguments.length!==2)return t[e];t[e]=n}var t={instrument:!1};e.config=t,e.configure=n}),e("promise/polyfill",["./promise","./utils","exports"],function(e,t,n){"use strict";function s(){var e;typeof global!="undefined"?e=global:typeof window!="undefined"&&window.document?e=window:e=self;var t="Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),i(t)}();t||(e.Promise=r)}var r=e.Promise,i=t.isFunction;n.polyfill=s}),e("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(e,t,n,r,i,s,o,u){"use strict";function b(e){if(!c(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof b))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],w(e,this)}function w(e,t){function n(e){A(t,e)}function r(e){M(t,e)}try{e(n,r)}catch(i){r(i)}}function E(e,t,n,r){var i=c(n),s,o,u,a;if(i)try{s=n(r),u=!0}catch(f){a=!0,o=f}else s=r,u=!0;if(L(t,s))return;i&&u?A(t,s):a?M(t,o):e===T?A(t,s):e===N&&M(t,s)}function C(e,t,n,r){var i=e._subscribers,s=i.length;i[s]=t,i[s+T]=n,i[s+N]=r}function k(e,t){var n,r,i=e._subscribers,s=e._detail;for(var o=0;o<i.length;o+=3)n=i[o],r=i[o+t],E(t,n,r,s);e._subscribers=null}function L(e,t){var n=null,r;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(l(t)){n=t.then;if(c(n))return n.call(t,function(n){if(r)return!0;r=!0,t!==n?A(e,n):O(e,n)},function(t){if(r)return!0;r=!0,M(e,t)}),!0}}catch(i){return r?!0:(M(e,i),!0)}return!1}function A(e,t){e===t?O(e,t):L(e,t)||O(e,t)}function O(e,t){if(e._state!==S)return;e._state=x,e._detail=t,a.async(_,e)}function M(e,t){if(e._state!==S)return;e._state=x,e._detail=t,a.async(D,e)}function _(e){k(e,e._state=T)}function D(e){k(e,e._state=N)}var a=e.config,f=e.configure,l=t.objectOrFunction,c=t.isFunction,h=t.now,p=n.all,d=r.race,v=i.resolve,m=s.reject,g=o.asap,y=0;a.async=g;var S=void 0,x=0,T=1,N=2;b.prototype={constructor:b,_state:undefined,_detail:undefined,_subscribers:undefined,then:function(e,t){var n=this,r=new this.constructor(function(){});if(this._state){var i=arguments;a.async(function(){E(n._state,r,i[n._state-1],n._detail)})}else C(this,r,e,t);return r},"catch":function(e){return this.then(null,e)}},b.all=p,b.race=d,b.resolve=v,b.reject=m,u.Promise=b}),e("promise/race",["./utils","exports"],function(e,t){"use strict";function r(e){var t=this;if(!n(e))throw new TypeError("You must pass an array to race.");return new t(function(t,n){var r=[],i;for(var s=0;s<e.length;s++)i=e[s],i&&typeof i.then=="function"?i.then(t,n):t(i)})}var n=e.isArray;t.race=r}),e("promise/reject",["exports"],function(e){"use strict";function t(e){var t=this;return new t(function(t,n){n(e)})}e.reject=t}),e("promise/resolve",["exports"],function(e){"use strict";function t(e){if(e&&typeof e=="object"&&e.constructor===this)return e;var t=this;return new t(function(t){t(e)})}e.resolve=t}),e("promise/utils",["exports"],function(e){"use strict";function t(e){return n(e)||typeof e=="object"&&e!==null}function n(e){return typeof e=="function"}function r(e){return Object.prototype.toString.call(e)==="[object Array]"}var i=Date.now||function(){return(new Date).getTime()};e.objectOrFunction=t,e.isFunction=n,e.isArray=r,e.now=i}),t("promise/polyfill").polyfill()})(),function(){"use strict";function n(n){var r=this,i={db:null};if(n)for(var s in n)i[s]=n[s];return new e(function(e,n){var s=t.open(i.name,i.version);s.onerror=function(){n(s.error)},s.onupgradeneeded=function(){s.result.createObjectStore(i.storeName)},s.onsuccess=function(){i.db=s.result,r._dbInfo=i,e()}})}function r(t,n){var r=this;typeof t!="string"&&(window.console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=new e(function(e,n){r.ready().then(function(){var i=r._dbInfo,s=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),o=s.get(t);o.onsuccess=function(){var t=o.result;t===undefined&&(t=null),e(t)},o.onerror=function(){n(o.error)}})["catch"](n)});return h(i,n),i}function i(t,n){var r=this,i=new e(function(e,n){r.ready().then(function(){var i=r._dbInfo,s=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),o=s.openCursor();o.onsuccess=function(){var n=o.result;if(n){var r=t(n.value,n.key);r!==void 0?e(r):n["continue"]()}else e()},o.onerror=function(){n(o.error)}})["catch"](n)});return h(i,n),i}function s(t,n,r){var i=this;typeof t!="string"&&(window.console.warn(t+" used as a key, but it is not a string."),t=String(t));var s=new e(function(e,r){i.ready().then(function(){var s=i._dbInfo,o=s.db.transaction(s.storeName,"readwrite").objectStore(s.storeName);n===null&&(n=undefined);var u=o.put(n,t);u.onsuccess=function(){n===undefined&&(n=null),e(n)},u.onerror=function(){r(u.error)}})["catch"](r)});return h(s,r),s}function o(t,n){var r=this;typeof t!="string"&&(window.console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=new e(function(e,n){r.ready().then(function(){var i=r._dbInfo,s=i.db.transaction(i.storeName,"readwrite").objectStore(i.storeName),o=s["delete"](t);o.onsuccess=function(){e()},o.onerror=function(){n(o.error)},o.onabort=function(e){var t=e.target.error;t==="QuotaExceededError"&&n(t)}})["catch"](n)});return h(i,n),i}function u(t){var n=this,r=new e(function(e,t){n.ready().then(function(){var r=n._dbInfo,i=r.db.transaction(r.storeName,"readwrite").objectStore(r.storeName),s=i.clear();s.onsuccess=function(){e()},s.onerror=function(){t(s.error)}})["catch"](t)});return h(r,t),r}function a(t){var n=this,r=new e(function(e,t){n.ready().then(function(){var r=n._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),s=i.count();s.onsuccess=function(){e(s.result)},s.onerror=function(){t(s.error)}})["catch"](t)});return c(r,t),r}function f(t,n){var r=this,i=new e(function(e,n){if(t<0){e(null);return}r.ready().then(function(){var i=r._dbInfo,s=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),o=!1,u=s.openCursor();u.onsuccess=function(){var n=u.result;if(!n){e(null);return}t===0?e(n.key):o?e(n.key):(o=!0,n.advance(t))},u.onerror=function(){n(u.error)}})["catch"](n)});return c(i,n),i}function l(t){var n=this,r=new e(function(e,t){n.ready().then(function(){var r=n._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),s=i.openCursor(),o=[];s.onsuccess=function(){var t=s.result;if(!t){e(o);return}o.push(t.key),t["continue"]()},s.onerror=function(){t(s.error)}})["catch"](t)});return c(r,t),r}function c(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function h(e,t){t&&e.then(function(e){p(t,e)},function(e){t(e)})}function p(e,t){if(e)return setTimeout(function(){return e(null,t)},0)}var e=typeof module!="undefined"&&module.exports?require("promise"):this.Promise,t=t||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(!t)return;var d={_driver:"asyncStorage",_initStorage:n,iterate:i,getItem:r,setItem:s,removeItem:o,clear:u,length:a,key:f,keys:l};typeof define=="function"&&define.amd?define("asyncStorage",function(){return d}):typeof module!="undefined"&&module.exports?module.exports=d:this.asyncStorage=d}.call(window),function(){"use strict";function r(t){var n=this,r={};if(t)for(var i in t)r[i]=t[i];return r.keyPrefix=r.name+"/",n._dbInfo=r,e.resolve()}function y(n){var r=this,i=new e(function(e,n){r.ready().then(function(){var n=r._dbInfo.keyPrefix;for(var i=t.length-1;i>=0;i--){var s=t.key(i);s.indexOf(n)===0&&t.removeItem(s)}e()})["catch"](n)});return A(i,n),i}function b(n,r){var i=this;typeof n!="string"&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var s=new e(function(e,r){i.ready().then(function(){try{var s=i._dbInfo,o=t.getItem(s.keyPrefix+n);o&&(o=N(o)),e(o)}catch(u){r(u)}})["catch"](r)});return A(s,r),s}function w(n,r){var i=this,s=new e(function(e,r){i.ready().then(function(){try{var s=i._dbInfo.keyPrefix,o=s.length,u=t.length;for(var a=0;a<u;a++){var f=t.key(a),l=t.getItem(f);l&&(l=N(l)),l=n(l,f.substring(o));if(l!==void 0){e(l);return}}e()}catch(c){r(c)}})["catch"](r)});return A(s,r),s}function E(n,r){var i=this,s=new e(function(e,r){i.ready().then(function(){var r=i._dbInfo,s;try{s=t.key(n)}catch(o){s=null}s&&(s=s.substring(r.keyPrefix.length)),e(s)})["catch"](r)});return A(s,r),s}function S(n){var r=this,i=new e(function(e,n){r.ready().then(function(){var n=r._dbInfo,i=t.length,s=[];for(var o=0;o<i;o++)t.key(o).indexOf(n.keyPrefix)===0&&s.push(t.key(o).substring(n.keyPrefix.length));e(s)})["catch"](n)});return A(i,n),i}function x(t){var n=this,r=new e(function(e,t){n.keys().then(function(t){e(t.length)})["catch"](t)});return A(r,t),r}function T(n,r){var i=this;typeof n!="string"&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var s=new e(function(e,r){i.ready().then(function(){var r=i._dbInfo;t.removeItem(r.keyPrefix+n),e()})["catch"](r)});return A(s,r),s}function N(e){if(e.substring(0,s)!==i)return JSON.parse(e);var t=e.substring(g),n=e.substring(s,g),r=new ArrayBuffer(t.length*2),y=new Uint16Array(r);for(var b=t.length-1;b>=0;b--)y[b]=t.charCodeAt(b);switch(n){case o:return r;case u:return new Blob([r]);case a:return new Int8Array(r);case f:return new Uint8Array(r);case l:return new Uint8ClampedArray(r);case c:return new Int16Array(r);case p:return new Uint16Array(r);case h:return new Int32Array(r);case d:return new Uint32Array(r);case v:return new Float32Array(r);case m:return new Float64Array(r);default:throw new Error("Unkown type: "+n)}}function C(e){var t="",n=new Uint16Array(e);try{t=String.fromCharCode.apply(null,n)}catch(r){for(var i=0;i<n.length;i++)t+=String.fromCharCode(n[i])}return t}function k(e,t){var n="";e&&(n=e.toString());if(e&&(e.toString()==="[object ArrayBuffer]"||e.buffer&&e.buffer.toString()==="[object ArrayBuffer]")){var r,s=i;e instanceof ArrayBuffer?(r=e,s+=o):(r=e.buffer,n==="[object Int8Array]"?s+=a:n==="[object Uint8Array]"?s+=f:n==="[object Uint8ClampedArray]"?s+=l:n==="[object Int16Array]"?s+=c:n==="[object Uint16Array]"?s+=p:n==="[object Int32Array]"?s+=h:n==="[object Uint32Array]"?s+=d:n==="[object Float32Array]"?s+=v:n==="[object Float64Array]"?s+=m:t(new Error("Failed to get type for BinaryArray"))),t(s+C(r))}else if(n==="[object Blob]"){var g=new FileReader;g.onload=function(){var e=C(this.result);t(i+u+e)},g.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(y){window.console.error("Couldn't convert value into a JSON string: ",e),t(y)}}function L(n,r,i){var s=this;typeof n!="string"&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var o=new e(function(e,i){s.ready().then(function(){r===undefined&&(r=null);var o=r;k(r,function(r,u){if(u)i(u);else{try{var a=s._dbInfo;t.setItem(a.keyPrefix+n,r)}catch(f){(f.name==="QuotaExceededError"||f.name==="NS_ERROR_DOM_QUOTA_REACHED")&&i(f)}e(o)}})})["catch"](i)});return A(o,i),o}function A(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var e=typeof module!="undefined"&&module.exports?require("promise"):this.Promise,t=null;try{if(!this.localStorage||!("setItem"in this.localStorage))return;t=this.localStorage}catch(n){return}var i="__lfsc__:",s=i.length,o="arbf",u="blob",a="si08",f="ui08",l="uic8",c="si16",h="si32",p="ur16",d="ui32",v="fl32",m="fl64",g=s+o.length,O={_driver:"localStorageWrapper",_initStorage:r,iterate:w,getItem:b,setItem:L,removeItem:T,clear:y,length:x,key:E,keys:S};typeof define=="function"&&define.amd?define("localStorageWrapper",function(){return O}):typeof module!="undefined"&&module.exports?module.exports=O:this.localStorageWrapper=O}.call(window),function(){"use strict";function g(e){var r=this,i={db:null};if(e)for(var s in e)i[s]=typeof e[s]!="string"?e[s].toString():e[s];return new t(function(t,s){try{i.db=n(i.name,String(i.version),i.description,i.size)}catch(o){return r.setDriver("localStorageWrapper").then(function(){return r._initStorage(e)}).then(t)["catch"](s)}i.db.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS "+i.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){r._dbInfo=i,t()},function(e,t){s(t)})})})}function y(e,n){var r=this;typeof e!="string"&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=new t(function(t,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){r.executeSql("SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=k(r)),t(r)},function(e,t){n(t)})})})["catch"](n)});return A(i,n),i}function b(e,n){var r=this,i=new t(function(t,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){r.executeSql("SELECT * FROM "+i.storeName,[],function(n,r){var i=r.rows,s=i.length;for(var o=0;o<s;o++){var u=i.item(o),a=u.value;a&&(a=k(a)),a=e(a,u.key);if(a!==void 0){t(a);return}}t()},function(e,t){n(t)})})})["catch"](n)});return A(i,n),i}function w(e,n,r){var i=this;typeof e!="string"&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var s=new t(function(t,r){i.ready().then(function(){n===undefined&&(n=null);var s=n;L(n,function(n,o){if(o)r(o);else{var u=i._dbInfo;u.db.transaction(function(i){i.executeSql("INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[e,n],function(){t(s)},function(e,t){r(t)})},function(e){e.code===e.QUOTA_ERR&&r(e)})}})})["catch"](r)});return A(s,r),s}function E(e,n){var r=this;typeof e!="string"&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=new t(function(t,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){r.executeSql("DELETE FROM "+i.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){n(t)})})})["catch"](n)});return A(i,n),i}function S(e){var n=this,r=new t(function(e,t){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){n.executeSql("DELETE FROM "+r.storeName,[],function(){e()},function(e,n){t(n)})})})["catch"](t)});return A(r,e),r}function x(e){var n=this,r=new t(function(e,t){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){n.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,n){t(n)})})})["catch"](t)});return A(r,e),r}function T(e,n){var r=this,i=new t(function(t,n){r.ready().then(function(){var i=r._dbInfo;i.db.transaction(function(r){r.executeSql("SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){n(t)})})})["catch"](n)});return A(i,n),i}function N(e){var n=this,r=new t(function(e,t){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){n.executeSql("SELECT key FROM "+r.storeName,[],function(t,n){var r=[];for(var i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)},function(e,n){t(n)})})})["catch"](t)});return A(r,e),r}function C(t){var n=new Uint8Array(t),r,i="";for(r=0;r<n.length;r+=3)i+=e[n[r]>>2],i+=e[(n[r]&3)<<4|n[r+1]>>4],i+=e[(n[r+1]&15)<<2|n[r+2]>>6],i+=e[n[r+2]&63];return n.length%3===2?i=i.substring(0,i.length-1)+"=":n.length%3===1&&(i=i.substring(0,i.length-2)+"=="),i}function k(t){if(t.substring(0,i)!==r)return JSON.parse(t);var n=t.substring(m),g=t.substring(i,m),y=n.length*.75,b=n.length,w,E=0,S,x,T,N;n[n.length-1]==="="&&(y--,n[n.length-2]==="="&&y--);var C=new ArrayBuffer(y),k=new Uint8Array(C);for(w=0;w<b;w+=4)S=e.indexOf(n[w]),x=e.indexOf(n[w+1]),T=e.indexOf(n[w+2]),N=e.indexOf(n[w+3]),k[E++]=S<<2|x>>4,k[E++]=(x&15)<<4|T>>2,k[E++]=(T&3)<<6|N&63;switch(g){case s:return C;case o:return new Blob([C]);case u:return new Int8Array(C);case a:return new Uint8Array(C);case f:return new Uint8ClampedArray(C);case l:return new Int16Array(C);case h:return new Uint16Array(C);case c:return new Int32Array(C);case p:return new Uint32Array(C);case d:return new Float32Array(C);case v:return new Float64Array(C);default:throw new Error("Unkown type: "+g)}}function L(e,t){var n="";e&&(n=e.toString());if(e&&(e.toString()==="[object ArrayBuffer]"||e.buffer&&e.buffer.toString()==="[object ArrayBuffer]")){var i,m=r;e instanceof ArrayBuffer?(i=e,m+=s):(i=e.buffer,n==="[object Int8Array]"?m+=u:n==="[object Uint8Array]"?m+=a:n==="[object Uint8ClampedArray]"?m+=f:n==="[object Int16Array]"?m+=l:n==="[object Uint16Array]"?m+=h:n==="[object Int32Array]"?m+=c:n==="[object Uint32Array]"?m+=p:n==="[object Float32Array]"?m+=d:n==="[object Float64Array]"?m+=v:t(new Error("Failed to get type for BinaryArray"))),t(m+C(i))}else if(n==="[object Blob]"){var g=new FileReader;g.onload=function(){var e=C(this.result);t(r+o+e)},g.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(y){window.console.error("Couldn't convert value into a JSON string: ",e),t(null,y)}}function A(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=typeof module!="undefined"&&module.exports?require("promise"):this.Promise,n=this.openDatabase,r="__lfsc__:",i=r.length,s="arbf",o="blob",u="si08",a="ui08",f="uic8",l="si16",c="si32",h="ur16",p="ui32",d="fl32",v="fl64",m=i+s.length;if(!n)return;var O={_driver:"webSQLStorage",_initStorage:g,iterate:b,getItem:y,setItem:w,removeItem:E,clear:S,length:x,key:T,keys:N};typeof define=="function"&&define.amd?define("webSQLStorage",function(){return O}):typeof module!="undefined"&&module.exports?module.exports=O:this.webSQLStorage=O}.call(window),function(){"use strict";function l(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function c(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(f(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}function h(e){for(var t in n)if(n.hasOwnProperty(t)&&n[t]===e)return!0;return!1}function d(e){this._config=c({},o,e),this._driverSet=null,this._ready=!1,this._dbInfo=null;for(var t=0;t<i.length;t++)l(this,i[t]);this.setDriver(this._config.driver)}var e=typeof module!="undefined"&&module.exports?require("promise"):this.Promise,t={},n={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},r=[n.INDEXEDDB,n.WEBSQL,n.LOCALSTORAGE],i=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],s={DEFINE:1,EXPORT:2,WINDOW:3},o={description:"",driver:r.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},u=s.WINDOW;typeof define=="function"&&define.amd?u=s.DEFINE:typeof module!="undefined"&&module.exports&&(u=s.EXPORT);var a=function(e){var t=t||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB,r={};return r[n.WEBSQL]=!!e.openDatabase,r[n.INDEXEDDB]=!!function(){if(typeof e.openDatabase!="undefined"&&e.navigator&&e.navigator.userAgent&&/Safari/.test(e.navigator.userAgent)&&!/Chrome/.test(e.navigator.userAgent))return!1;try{return t&&typeof t.open=="function"&&typeof e.IDBKeyRange!="undefined"}catch(n){return!1}}(),r[n.LOCALSTORAGE]=!!function(){try{return e.localStorage&&"setItem"in e.localStorage&&e.localStorage.setItem}catch(t){return!1}}(),r}(this),f=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},p=this;d.prototype.INDEXEDDB=n.INDEXEDDB,d.prototype.LOCALSTORAGE=n.LOCALSTORAGE,d.prototype.WEBSQL=n.WEBSQL,d.prototype.config=function(e){if(typeof e=="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e)t==="storeName"&&(e[t]=e[t].replace(/\W/g,"_")),this._config[t]=e[t];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return typeof e=="string"?this._config[e]:this._config},d.prototype.defineDriver=function(n,r,s){var o=new e(function(r,s){try{var o=n._driver,u=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),f=new Error("Custom driver name already in use: "+n._driver);if(!n._driver){s(u);return}if(h(n._driver)){s(f);return}var l=i.concat("_initStorage");for(var c=0;c<l.length;c++){var p=l[c];if(!p||!n[p]||typeof n[p]!="function"){s(u);return}}var d=e.resolve(!0);"_support"in n&&(n._support&&typeof n._support=="function"?d=n._support():d=e.resolve(!!n._support)),d.then(function(e){a[o]=e,t[o]=n,r()},s)}catch(v){s(v)}});return o.then(r,s),o},d.prototype.driver=function(){return this._driver||null},d.prototype.ready=function(t){var n=this,r=new e(function(e,t){n._driverSet.then(function(){n._ready===null&&(n._ready=n._initStorage(n._config)),n._ready.then(e,t)})["catch"](t)});return r.then(t,t),r},d.prototype.setDriver=function(n,r,i){function a(){o._config.driver=o.driver()}var o=this;return typeof n=="string"&&(n=[n]),this._driverSet=new e(function(r,i){var a=o._getFirstSupportedDriver(n),f=new Error("No available storage method found.");if(!a){o._driverSet=e.reject(f),i(f);return}o._dbInfo=null,o._ready=null;if(h(a)){if(u===s.DEFINE){require([a],function(e){o._extend(e),r()});return}if(u===s.EXPORT){var l;switch(a){case o.INDEXEDDB:l=require("./drivers/indexeddb");break;case o.LOCALSTORAGE:l=require("./drivers/localstorage");break;case o.WEBSQL:l=require("./drivers/websql")}o._extend(l)}else o._extend(p[a])}else{if(!t[a]){o._driverSet=e.reject(f),i(f);return}o._extend(t[a])}r()}),this._driverSet.then(a,a),this._driverSet.then(r,i),this._driverSet},d.prototype.supports=function(e){return!!a[e]},d.prototype._extend=function(e){c(this,e)},d.prototype._getFirstSupportedDriver=function(e){if(e&&f(e))for(var t=0;t<e.length;t++){var n=e[t];if(this.supports(n))return n}return null},d.prototype.createInstance=function(e){return new d(e)};var v=new d;u===s.DEFINE?define("localforage",function(){return v}):u===s.EXPORT?module.exports=v:this.localforage=v}.call(window)