define(function(){function e(e,t,n){utils.api("/_bridge/role/{id}/authorities".replace("{id}",e),{method:"post",data:{authId:t},onError:function(e,t){n({node_code:null,msg:"server error"})}}).done(function(e,t){n(e)})}return function(t){var n=this,r=$(t.currentTarget.lastChild),i=$(n).data("id"),s=r.data("id"),o=r.clone(!0),u=$(t.target).hasClass("item")?$(t.target):$(t.target).parents("li.item"),a=$(this).find(".empty");a.length>0&&(u=a),r.remove(),u.length>0?o.insertAfter(u):$(this).append(o),o.append($('<div class="ui "> <div class="ui active inverted dimmer"> <div class="ui text loader"></div> </div> <p></p> </div> ')),dialog({title:"确认操作",quickClose:!0,align:"right top",okValue:"提交",cancelValue:"取消",content:"操作类型为重要操作，请确认是否要继续？",ok:function(){e(i,s,function(e){o.find(".ui").remove();if(e["node_code"]!=2e4)return utils.bubble("权限分配失败"),o.remove();a.remove(),utils.bubble("权限已分配给角色")})},cancel:function(){return o.remove(),!0}}).show(o[0])}})