define(function(){function t(e,t){utils.api("/_bridge/admin/permission/url/delete",{method:"post",data:{id:e}}).done(function(e){t(e)})}function n(e){e.on("click",".url .menu .delete",function(e){var n=$(this).parents(".url"),r=n.data("id");dialog({title:"删除权限",quickClose:!0,align:"left",okValue:"提交",cancelValue:"取消",content:"操作类型为重要操作，请确认是否要继续？",ok:function(){t(r,function(e){if(e["node_code"]!=2e4)return utils.bubble("权限移除失败");n.addClass("animated zoomOut").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).remove()}),utils.bubble("权限成功移除！")})},cancel:function(){return!0}}).show(e.target)})}function r(t){t.on("click",".url .menu .update",function(t){var n=$(this).parents(".url"),r=n.find("ul").data("id"),i=n.find("h2 span").text(),s=n.find("h2 p").text();dialog({title:"编辑权限",quickClose:!0,align:"left",okValue:"提交",cancelValue:"取消",content:_.template(e,{id:r,name:i,content:s}),ok:function(){var e=$(this.node).find("input[name=name]").val(),t=$(this.node).find("input[name=content]").val();$(this.node).find("form").ajaxSubmit({success:function(r){if(r["node_code"]!=2e4)return utils.bubble("权限更新失败");utils.bubble("权限已更新！"),n.find("h2 span").text(e),n.find("h2 p").text(t)},error:function(){}})},cancel:function(){return!0}}).show(t.target)})}function i(e){e.find(".panel ul li").draggable({}).on("start",function(e){$(this).addClass("yellow")}),r(e),n(e)}var e=['<form action="/_bridge/admin/permission/role/update" method="post">',"<div>",'<input type="hidden" value="<%= id %>" name="id"  />','    <div class="ui fluid icon input">','        <input type="text" name="name" placeholder="权限名" value="<%= name %>" >','        <i class="home icon"></i>',"    </div> <br />",'    <div class="ui fluid icon input">','        <input type="text" name="content" placeholder="描述" value="<%= content %>">','        <i class="text file icon"></i>',"    </div>","</form>","</div>"].join("");return{init:function(){var e=$(".mod-permission-manage .sub-mod-url");i(e)}}})