define(["mod/common/widget/waterflow"],function(e){function n(e){e.on("click",".pic",function(e){var t=$(this).parents(".item"),n=t.data("id");utils.openWindow({url:"/atlas/"+n+"/detail?__pipe__=1"})})}function r(e){n(e),i(e)}function i(e){e.on("click",".delete",function(e){var n=$(this).parents(".item"),r=this,i=n.data("id"),s=dialog({title:"您即将删除该图集",content:"确定删除?",okValue:"确定",cancelValue:"取消",ok:function(){t(i,e)},cancel:function(){return!0}});s.showModal()})}var t=function(e,t){t.stopPropagation(),t.preventDefault(),utils.api("/_bridge/admin/atlas/delete",{method:"post",data:{id:e}}).done(function(e,n){e["node_code"]==2e4&&(utils.bubble("图集已经删除"),$(t.target).parents(".item").remove(),_SmartPipe_.reload())})};return{init:function(t){var n=$(".mod-user-atlas-list"),i=n.data("type"),s="/_bridge/atlas/list/user",o=utils.queryString(location.search);r(n),new e({el:n.find(".box-wrapper")[0],url:s,query:{page:o.page||1,limit:40,userId:o.uid},itemFormat:function(e){return $.extend({},e.atlas,{createBy:e.user.id,nickname:e.user.nickname,coverImage:e.coverKey[0],avator:e.user.headUrl})},format:function(e){return e.data.resp.items}})}}})