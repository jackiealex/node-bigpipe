define(function(){function e(e){e.on("click",".config-mod",function(e){var t=$(this).parent().parent().find("td[data-name]").data("name"),n=$(this).parent().parent().find("td[data-value]").data("value"),r=$(this).parent().parent().find("td[data-description]").data("description"),i=['<div class="ui warning form segment">','	<div class="ui warning message">','		<div class="header">确定要修改，慎重！</div>',"	</div>",'    <div class="field">',"        <label>名字</label>",'        <input disabled="disabled" type="text" name="name" placeholder="name" value="'+t+'">',"    </div>",'    <div class="field">',"        <label>值</label>",'        <input type="text" name="value" placeholder="value" value="'+n+'">',"    </div>",'	<div class="field">',"		<label>描述</label>",'		<textarea name="description" placeholder="description">'+r+"</textarea>","	</div>","</div>"].join(""),s=dialog({title:"修改配置项",content:i,width:600,okValue:"修改",cancelValue:"取消",cancel:function(){return!0},ok:function(){var e=$(this.node).find("input[name=value]").val(),t=$(this.node).find("input[name=name]").val(),n=$(this.node).find("textarea[name=description]").text();return utils.api("/_bridge/public/config",{method:"post",data:{value:e,name:t,description:n}}).done(function(e,t){if(e["node_code"]!=2e4)return utils.bubble(e.data.msg);utils.bubble("修改成功"),setTimeout(_SmartPipe_.reload(),5e3)}),!0}});s.showModal()})}function t(e){e.on("click",".btn-add-item",function(e){var t=['<form class="ui form">','    <div class="field">',"        <label>名字（只能是字母和下划线［a-z］+ _ + .）</label>",'        <input type="text" name="name" placeholder="name">',"    </div>",'    <div class="field">',"        <label>值</label>",'        <input type="text" name="value" placeholder="value">',"    </div>",'    <div class="field">',"        <label>描述</label>",'        <textarea name="description" placeholder="description"></textarea>',"    </div>","</form>"].join(""),n=dialog({title:"添加配置项",content:t,width:400,okValue:"添加",cancelValue:"取消",cancel:function(){return!0},ok:function(){var e=$(this.node).find("form input[name=name]").val(),t=$(this.node).find("form input[name=value]").val(),n=$(this.node).find("form textarea[name=description]").text();return!e||!t?(utils.bubble("请输入完整信息"),!1):(utils.api("/_bridge/public/config",{method:"post",data:{value:t,name:e,description:n}}).done(function(e,t){if(e["node_code"]!=2e4)return utils.bubble(e.data.msg);utils.bubble("添加成功"),setTimeout(_SmartPipe_.reload(),5e3)}),!0)}});n.showModal()})}function n(e){e.on("click",".config-del",function(e){var t=$(this).parent().parent().find("td[data-name]").data("name"),n=dialog({title:"删除配置项",content:"确定要删除？慎重！",okValue:"确定",cancelValue:"取消",cancel:function(){return!0},ok:function(){return utils.api("/_bridge/public/config?name="+t,{method:"delete"}).done(function(e,t){if(e["node_code"]!=2e4)return utils.bubble(e.data.msg);utils.bubble("删除成功"),setTimeout(_SmartPipe_.reload(),5e3)}),!0}});n.showModal()})}function r(r){e(r),t(r),n(r)}return{init:function(){var e=$(".mod-system-config");r(e)}}})