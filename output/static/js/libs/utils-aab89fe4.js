(function(e){e.utils={nextTick:function(e,t){setTimeout(function(){e()},t||0)},bubble:function(e,t){if(Notification){if(Notification.permission==="granted"){var e=$("<div />").html(e).text(),n=new Notification("通知",{icon:"http://7xlphm.com1.z0.glb.clouddn.com/static/img/logo-ae37feef.png",body:e});return utils.nextTick(function(){n.close()},4e3)}Notification.requestPermission()}var r=$('<div class="bubble"/>').html(e);$("body").append(r),utils.nextTick(function(){r.addClass("slide-down")}),utils.nextTick(function(){r.animate({opacity:.62},2e3).animate({top:-10},function(){this.remove()})},1e3)},createElementTip:function(e,t){var n=$(e).offset(),r=['<div class="widget-tip">',t.text||"","</div>"].join(""),i=$(r);$("body").append(i.css(n)),setTimeout(function(e){i.addClass("animated fadeOutUp").on(_VENDOR_+"AnimationEnd",function(e){$(this).remove()})},1800)},xTemplate:function(e,t){return _.template(e).call(t,t)},queryString:function(e){return typeof e!="string"?{}:(e=e.trim().replace(/^(\?|#|&)/,""),e?e.split("&").reduce(function(e,t){var n=t.replace(/\+/g," ").split("="),r=n[0],i=n[1];return r=decodeURIComponent(r),i=i===undefined?null:decodeURIComponent(i),e.hasOwnProperty(r)?Array.isArray(e[r])?e[r].push(i):e[r]=[e[r],i]:e[r]=i,e},{}):{})},JSONParse:function(e){return(new Function("return "+e))()},api:function(e,t){var n=$.Deferred();return t=$.extend({method:"get",dataType:"json",data:{},onError:function(e){var n=e.msg+" =:= "+JSON.stringify(t.data);e.data&&(e.data.msg||"操作异常了"),utils.bubble(n);return}},t),$.ajax({method:t.method,dataType:t.dataType,url:e,data:t.data,success:function(e,r){if(t["dataType"]=="text")return n.resolve.apply(null,arguments);e["node_code"]!=2e4&&t.onError(e),n.resolve(e)},error:function(e,t){utils.bubble("请求错误"),n.resolve.apply(null,arguments)}}),n.promise()},openWindow:function(e){var t=$("body");_SmartPipe_.doPipeRequest(e);var n=['<div id="window">','<div class="win-close"><i class="remove large icon"></i></div>','<div class="win-content">loading......</div>',"</div>"].join("");t.append(n),t.on("click","#window .win-close",function(){$("#window").remove()})},loading:function(){var e=$('<div class="widget-loading" />');return $("body").append(e),{remove:function(){$(".widget-loading").remove()}}},getHoursOfDay:function(){var e=[];for(var t=1;t<=24;t++)e.push(t+"时");return e},getDaysOfWeek:function(){return["一","二","三","四","五","六","日"]},getMonthLastDay:function(e){var t=new Date(e.getFullYear(),e.getDate()+1,1);return t=+t-864e5,dateFormat(t)},offsetNumber:function(e,t){return t||(t="0"),(e+"").length<2?t+""+e:e},getDaysArray:function(e,t){typeof e=="string"&&(e=+(new Date(e))),typeof t=="string"&&(t=+(new Date(t)));var n=864e5,r=[];for(var i=e;i<=t;i+=n)r.push(utils.dateFormat(i));return r},dateFormat:function(e,t){t||(t="-");var n=new Date(e),r=[n.getFullYear(),utils.offsetNumber(n.getMonth()+1),utils.offsetNumber(n.getDate())].join(t);return r},dateTimeFormat:function(e){var t=new Date(e),n=[t.getFullYear(),utils.offsetNumber(t.getMonth()+1),utils.offsetNumber(t.getDate())].join("/"),r=[utils.offsetNumber(t.getHours()),utils.offsetNumber(t.getMinutes())].join(":");return n+" "+r}}})(window)